<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="commu">

  <!-- 자료실 저장 -->
  <insert id="commu_in" parameterType="commu"> <!-- parameterType은 전달인자 자료형으로
  												생략가능함 -->
    insert into  comu_post(comu_no,title,content,writer,regdate)values(comu_no_seq.nextval,
    #{writer},#{title},#{content},sysdate)
    <!-- #{bbs_name}을 자바코드로 표현하면 bbs.getBbs_name();과 같은 기능을 한다. -->
    <!-- 과제물 :upload폴더에 실제 변경된 이진파일이 업로드 되게하고, bbs테이블에 레코드를 저장되게 해보자 -->
  </insert>
  
  <!-- 검색 전후 레코드 개수 -->
  <select id="commu_count" resultType="int"><!-- resultType 속성은 반환 자료형 -->
    select count(comu_no) from comu_post
    <where>
      <if test="find_field==''"></if><!-- 검색전 -->
      <if test="find_field=='title'"> <!-- 글제목 기준으로 검색할 때 -->
        comm_title like #{find_name}
      </if>
      <if test="find_field=='content'"><!-- 글내용 기준으로 검색할때 -->
       comm_cont like #{find_name}
      </if>
    </where>
  </select>
  
  <!-- 검색 전후 자료실 목록 -->
  <select id="commu_list" resultType="commu">
    select * from (select rowNum rNum,comu_no,title,writer,
    regdate from 
      (select * from comu_post
      <where>
        <if test="find_field==''"></if>
        <if test="find_field=='title'">
          comm_title like #{find_name}
        </if>
        <if test="find_field=='content'">
          comm_cont like #{find_name} <!-- like는 ~와 비슷한 문자를 검색하는 검색연산자 -->
        </if>
        
      </where>
        ))
        where rNum &gt;=#{startrow} and rNum &lt;=#{endrow}
        <!-- #gt;= 은 >=의 뜻, &lt;= 은 <= 의 뜻 -->
  </select>
  
  

</mapper>